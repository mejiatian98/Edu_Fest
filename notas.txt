{% extends 'dashboard_principal_participante.html' %}
{% load static %}

{% block title %}Agregar Miembros{% endblock %}

{% block content %}
<div class="container mt-5 mb-5">
    <h2 class="contenedor">Agregar Miembros</h2>
    <hr>

    <form method="POST" enctype="multipart/form-data" novalidate id="formParticipante">
        {% csrf_token %}

        <div class="row-12">
            <h5 class="mb-3">Datos del Exponente</h5>
            <div class="col mb-3">
                <label for="id" class="form-label">Cédula</label>
                {{ form.cedula}}
                {% if form.cedula.errors %}
                    <div class="text-danger">
                        {{ form.cedula.errors }}
                    </div>
                {% endif %}
            </div>

            <div class="col mb-3">
                <label for="username" class="form-label">Nombre de usuario</label>
                {{ form.username }}
                {% if form.username.errors %}
                    <div class="text-danger">
                        {{ form.username.errors }}
                    </div>
                {% endif %}
            </div>

            

            <div class="col mb-3">
                <label for="email" class="form-label">Correo electrónico</label>
                {{ form.email }}
                {% if form.email.errors %}
                    <div class="text-danger">
                        {{ form.email.errors }}
                    </div>
                {% endif %}
            </div>
        </div>

        <div class="row-12">
            <div class="col mb-3">
                <label for="telefono" class="form-label">Teléfono</label>
                {{ form.telefono }}
                {% if form.telefono.errors %}
                    <div class="text-danger">
                        {{ form.telefono.errors }}
                    </div>
                {% endif %}
            </div>
            <div class="col mb-3">
                <label for="first_name" class="form-label">Nombre</label>
                {{ form.first_name }}
                {% if form.first_name.errors %}
                    <div class="text-danger">
                        {{ form.first_name.errors }}
                    </div>
                {% endif %}
            </div>

            <div class="col mb-3">
                <label for="last_name" class="form-label">Apellido</label>
                {{ form.last_name }}
                {% if form.last_name.errors %}
                    <div class="text-danger">
                        {{ form.last_name.errors }}
                    </div>
                {% endif %}
            </div>
        </div>
        
        <div class="mt-5 text-center">
            <button type="submit" class="btn btn-primary">Agregar Miembros</button>
        </div>
    </form>
</div>

{% endblock %}


    path('agregar_miembros/<int:evento_id>/', views.AgregarMiembrosView.as_view(), name='agregar_miembro_par'),



############# AGREGAR MIEMBROS ################

@method_decorator(login_required, name='dispatch') 
class AgregarMiembrosView(View):
    template_name = 'agregar_miembros.html'
    def get(self, request,
            evento_id, ):
        evento = get_object_or_404(Evento, id=evento_id)


        form = ParticipanteForm()
        return render(request, self.template_name, {
            'form': form,
            'evento': evento,

        })
    



Ok, vamos por pasos, quiero agregar un miembro a mi grupo, el cual yo soy el lider, 
en el front, (html) lleno el formulario del participante, este se guardara.

en el backend (view) 
1 - al guardar los datos del participante quiero que se guarden en la tabla USUARIO asi como vienes haciendolo como con los asistentes y evaluadores, con rol PARTICIPANTE y recuerda que el last_login lo dejas null 
2- hacer la relacion con el evento en participanteevento y en participante, en participanteevento, debes poner al participante en par_eve_estado como "Aprobado" generar el par_eve_clave y generar la img Qr en par_eve_qr y en par_eve_proyecto_principal_id dejalo en null
3- tambien hacer la relacion en la tabla usuario_groups
4- Enviar mensaje al correo del participante De que ya ha sido asignado al grupo (nombre del grupo que esta en la tabla group en el campo name) tambien adjuntar la imagen del qr mas clave de acceso y enviar la contraseña que se genero en la tabla usuario en campo password y correo para poder acceder


validaciones, al crear, que este no genere duplicidad en la tabla USUARIO.
Solo pueden haber como maximo 5 personas en un grupo incluido el lider.